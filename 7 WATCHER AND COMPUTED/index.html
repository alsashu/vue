<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q"
    crossorigin="anonymous"></script>

  <title>MOVIEOPEDIA - BASE SETUP</title>

</head>

<body>
  <div id="app" class="container">
    <h1>MOVIEOPEDIA - BASE SETUP</h1>
    <hr />
    <div class="bg-info p-5 rounded m-5">
      <div class="h1 text-center">VUE JS - MOVIEOPEDIA</div>
      <hr />

      <div class="input-group mb-3">
        <span class="input-group-text">Title</span>
        <input type="text" class="form-control" v-model="newMovies.title" />
      </div>

      <div class="input-group mb-3">
        <span class="input-group-text">Years</span>
        <input type="text" class="form-control" v-model="newMovies.year" />
      </div>

      <div class="input-group mb-3">
        <button class="btn btn-success m-2 w-25" v-on:click="addMovie">Add</button>
        <button class="btn btn-danger m-2 w-25" @click="removeMovie">REMOVE</button>
      </div>

      <div class="border p-3 w-100 mx-auto">
        <div class="text-center">
          <h4 class="text-center">Movie List</h4>
          <!-- <span class="text-warning" v-if="movies.length >= 3">Warning: You can only add 5 movies</span> -->

          <span class="text-danger" v-if="movies.length > 3">Error: You can only add 5 movies</span>
          <hr />
        </div>
        <ul class="list-group">
          <li v-for="m in getMovieText()" class="list-group-item">
            {{m}}
          </li>
        </ul>
      </div>

      <div class="border p-3 w-100 mx-auto">
        <div class="text-center">
          <h4 class="text-center">Movie List using computed property</h4>
          <span class="text-danger" v-if="showMessage">Error: You can only add 5 movies</span>
          <hr />
        </div>
        <ul class="list-group">
          <li v-for="m in getMovieTextComputed" class="list-group-item">
            {{m}}
          </li>
        </ul>
      </div>

      <div class="border p-3 w-100 mx-auto">
        <div class="text-center">
          <h4 class="text-center">Movie List using computed property & watch async</h4>
          <span class="text-danger" v-if="showAnotherMessage">Error: You can only add 5 movies</span>
          <hr />
        </div>
        <ul class="list-group">
          <li v-for="m in getMovieTextComputed" class="list-group-item">
            {{m}}
          </li>
        </ul>
      </div>
    </div>
  </div>
</body>
<script>
  const { createApp, ref, reactive, computed, watch } = Vue;

  createApp({
    setup() {

      let movies = reactive([
        { title: "Raid", year: 2020 },
        { title: "Sinners", year: 2025 },
        { title: "Edington", year: 2025 }]);

      let newMovies = reactive({ title: "", year: "" });
      let showMessage = ref(false);
      let showAnotherMessage = ref(false);

      function addMovie() {
        if (movies.length < 5) {
          movies.push({ title: newMovies.title, year: newMovies.year });
          newMovies.title = "";
          newMovies.year = "";
        }
      }

      function removeMovie() {
        movies.pop();
      }

      function getMovieText() {
        return movies.map((movie) => {
          return `${movie.title} was released in ${movie.year}`
        })
      }

      const getMovieTextComputed = computed(() => {
        return movies.map((movie) => {
          return `${movie.title} was released in ${movie.year}`
        })
      });

      watch(movies, () => {
        if (movies.length >= 3) {
          showMessage.value = true;
        } else {
          showMessage.value = false;
        }
      })

      watch(movies, async () => {
        if (movies.length >= 3) {
          setTimeout(() => {
            showAnotherMessage.value = true;
          }, 3000);
        } else {
          showAnotherMessage.value = false;
        }
      })

      return {
        movies,
        newMovies,
        addMovie,
        removeMovie,
        getMovieText,
        showMessage,
        getMovieTextComputed,
        showAnotherMessage
      }
    }
  }).mount('#app');
</script>

</html>